% Step 1: Read the CSV file
filename = 'TCGA_LUAD_miRNA_expression_disease_status.csv' 
data = readtable(filename, 'ReadRowNames', true);
feature_names = data.Properties.VariableNames(1:end-1);
X = table2array(data(:, 1:end-1));  % Convert table to array, excluding the last column (label)
Y = data.disease_status;  % Use the last column as the label vector

% Step 2: Set the k value for ReliefF
k = 50;  % You can change this value based on your needs

% Step 3: Perform ReliefF feature selection
[weights, ranks]= relieff(X, Y, k);

% Sorting weights in descending order and getting the indices
[sortedWeights, sortedIndices] = sort(weights, 'descend');

% Selecting the desired number of features
num_features_to_select = 100;  % Set the desired number of features to select
selected_indices = sortedIndices(1:num_features_to_select);

% Step 4: Export the names of the selected features into a CSV file
selected_feature_names = feature_names(selected_indices);
writetable(cell2table(selected_feature_names'), 'LUAD_miRNA_selected_features_50.csv', 'WriteVariableNames', false);


